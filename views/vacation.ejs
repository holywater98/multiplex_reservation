<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title></title>
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900" rel="stylesheet" />
  <link href="\stylesheets\default.css" rel="stylesheet" type="text/css" media="all" />
  <link href="\stylesheets\fonts.css" rel="stylesheet" type="text/css" media="all" />
  <link href="\stylesheets\admin.css" rel="stylesheet" type="text/css" />
  <script src="http://code.jquery.com/jquery-1.10.2.js"></script>

  <style type="text/css">
    /* tg1 윗 표, tg 아랫 표 */
    .tg1 {
      border-collapse: collapse;
      border-spacing: 0;
      border-color: #93a1a1;
    }

    .tg1 td {
      font-family: Arial, sans-serif;
      font-size: 14px;
      padding: 7px 5px;
      border-style: solid;
      border-width: 1px;
      overflow: hidden;
      word-break: normal;
      border-color: #93a1a1;
      color: #002b36;
      background-color: #fdf6e3;
    }

    .tg1 th {
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: normal;
      padding: 7px 5px;
      border-style: solid;
      border-width: 1px;
      overflow: hidden;
      word-break: normal;
      border-color: #93a1a1;
      color: #fdf6e3;
      background-color: #657b83;
    }

    .tg1 .tg-rbrk {
      background-color: white;
      border-color: inherit;
      text-align: left;
      vertical-align: top
    }

    .tg1 .tg-myid {
      border-color: inherit;
      text-align: left;
      vertical-align: top
    }

    .tg {
      border-collapse: collapse;
      border-spacing: 0;
      border-color: #ccc;
    }

    .tg td {
      font-family: Arial, sans-serif;
      font-size: 10px;
      padding: 10px 5px;
      border-style: solid;
      border-width: 0px;
      overflow: hidden;
      word-break: normal;
      border-top-width: 1px;
      border-bottom-width: 1px;
      border-color: #ccc;
      color: #333;
      background-color: #fff;
    }

    .tg th {
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: normal;
      padding: 10px 5px;
      border-style: solid;
      border-width: 0px;
      overflow: hidden;
      word-break: normal;
      border-top-width: 1px;
      border-bottom-width: 1px;
      border-color: #ccc;
      color: #333;
      background-color: #f0f0f0;
    }

    .tg .tg-part {
      border-color: inherit;
      text-align: center;
      vertical-align: top
    }

    .tg .tg-valu {
      border-color: inherit;
      text-align: left;
      vertical-align: top
    }
  </style>
</head>

<body>
  <div id="header-wrapper">
    <div id="header" class="container">
      <div id="logo">
        <h1><a href="/admin">직원 관리 시스템</a></h1>

        <span>By <a href="#">CENEMA</a></span>
      </div>
      <div id="menu">
        <ul>
          <li><a href="/admin/info" accesskey="1" title="">사원정보</a></li>
          <li><a href="/admin/sales" accesskey="2" title="">매 출</a></li>
          <li><a href="/admin/salary" accesskey="3" title="">급 여</a></li>
          <li><a href="/admin/rewards" accesskey="4" title="">근 태</a></li>
          <li class="current_page_item"><a href="/admin/vacation" accesskey="5" title="">휴 가</a></li>

        </ul>
      </div>
    </div>
  </div>
  <div id="ebox1">
    <a href="#" class="button">휴 가</a>
  </div>
  <div id="registerVac">
    <button id="myBtn">휴가 등록</button>
  </div>
  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <form method="POST" action="/admin/vacation">
        <div>
          <label for="employee_id"> 직원ID </label>
          <div id="employee_id">
            <input type="text" name="employee_id" size="10" style="margin-left:20px;margin-right:20px">
          </div>
        </div>
        <div>
          <label for="sdate"> 휴가시작일자 </label>
          <div id="sdate">
            <input type="text" name="sdate" size="10" style="margin-left:20px;margin-right:20px">
          </div>
        </div>
        <div>
          <label for="edate"> 휴가종료일자 </label>
          <div id="edate">
            <input type="text" name="edate" size="10" style="margin-left:20px;margin-right:20px">
          </div>
        </div>
        <div id="enter">
          <input type="submit" value="입력"
            style="letter-spacing:1px;margin-left:20px;padding-left:5px;padding-right:5px">
        </div>
      </form>
    </div>
  </div>

  <% for(var i = 0; i < results1.length; i++) { 
    var employee_id = results1[i].employee_id;
  var year_left = results1[i].year;
  if(results1[i].employee_rank == 1){
    year_left = 15 - results1[i].year;
  } else{
    year_left = 1 - results1[i].year;
  }
  %>

  <table class="tg1" width="90%" style="table-layout:fixed; margin-top:15px" align="center">
    <tr>
      <th class="tg-myid">ID </th>
      <th class="tg-myid"><%=results1[i].employee_id%></th>
      <th class="tg-myid">성명 </th>
      <th class="tg-myid"><%=results1[i].employee_name%><button id="vacationBtn"> + </button></th>
    </tr>
    <tr>
      <td class="tg-rbrk">사용 휴가일 수</td>
      <td class="tg-rbrk"><%=year_left%></td>
      <td class="tg-rbrk">잔여 휴가일 수</td>
      <td class="tg-rbrk"><%=results1[i].year%></td>
    </tr>
  </table>

  <div class="vacationModal none" style="margin-top:15px">
    <table class="tg" width="90%" style="table-layout:fixed" align="center">
      <tr>
        <th class="tg-part">휴가시작일자</th>
        <th class="tg-part">휴가종료일자</th>
        <th class="tg-part">휴가승인여부</th>
        <th class="tg-part">사용 휴가일 수</th>
      </tr>


      <% if(results2.length != 0){
  for(var j = 0; j < results2.length; j++) {
      if(employee_id == results2[j].employee_id){ 
        var sdate = String(results2[j].sdate).split(' ');
        if(sdate[1] == "Dec"){
          sdate[1] = 12;
        }
        var edate = String(results2[j].edate).split(' ');
        if(edate[1] == "Dec"){
          edate[1] = 12;
        }
  %>
      <tr>
        <td class="tg-valu"><%=`${sdate[3]}/${sdate[1]}/${sdate[2]}`%></td>
        <td class="tg-valu"><%=`${edate[3]}/${edate[1]}/${edate[2]}`%></td>
        <td class="tg-valu">Y</td>
        <td class="tg-valu"></td>
      </tr>

      <%  } 
  }
}%>
    </table>
  </div>

  <%}%>

</body>


</body>

<script type="text/javascript">
  var button = document.querySelectorAll("button");
  var vacationmodal = document.getElementsByClassName("vacationModal");
  var btn = document.getElementById("vacationBtn");

  for (let i = 0; i < button.length - 1; i++) {
    document.querySelectorAll("button")[i + 1].addEventListener("click", function () {
      vacationmodal[i].classList.toggle("none");
    });
  }

</script>

<script type="text/javascript">
  var modal = document.getElementById('myModal');
  var btn = document.getElementById("myBtn");
  var span = document.getElementsByClassName("close")[0];
  btn.onclick = function () {
    modal.style.display = "block";
  }

  span.onclick = function () {
    modal.style.display = "none";
  }

  window.onclick = function (event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
</script>
</html>